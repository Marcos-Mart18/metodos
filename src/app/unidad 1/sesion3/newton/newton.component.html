<div>
  <a
    routerLink="/sesion3"
    class="inline-flex items-center gap-2 bg-gradient-to-b from-[#001C48] to-[#003366] text-white font-bold text-sm px-4 py-2 rounded-lg shadow-md hover:shadow-lg hover:from-[#003366] hover:to-[#004080] hover:-translate-y-0.5 transition"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M19 11H7.14l3.63-4.36a1 1 0 1 0-1.54-1.28l-5 6a1 1 0 0 0 0 1.28l5 6A1 1 0 0 0 10 19a1 1 0 0 0 .77-1.64L7.14 13H19a1 1 0 0 0 0-2z"
      />
    </svg>
    <span>Volver</span>
  </a>
</div>

<div class="max-w-6xl mx-auto mt-6 px-4 space-y-6">
  <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
    <h2 class="text-xl font-bold mb-4 text-[#001C48]">Método de Newton-Raphson</h2>

    <!-- Inputs -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label class="block text-sm font-medium text-[#001C48]">Ecuación f(x)</label>
        <input
          [(ngModel)]="ecuacion"
          class="w-full p-2 rounded bg-gray-100 border border-gray-300 focus:ring-2 focus:ring-[#3BAFDA]"
          type="text"
          placeholder="Ej: x^3 - x - 2"
        />
        <div class="mt-2 grid grid-cols-6 gap-2 text-sm">
          <button (click)="insertar('^')" type="button" class="p-2 bg-gray-200 rounded">^</button>
          <button (click)="insertar('sqrt()')" type="button" class="p-2 bg-gray-200 rounded">√</button>
          <button (click)="insertar('pi')" type="button" class="p-2 bg-gray-200 rounded">π</button>
          <button (click)="insertar('sin()')" type="button" class="p-2 bg-gray-200 rounded">sin</button>
          <button (click)="insertar('cos()')" type="button" class="p-2 bg-gray-200 rounded">cos</button>
          <button (click)="insertar('tan()')" type="button" class="p-2 bg-gray-200 rounded">tan</button>
        </div>
        <div *ngIf="mensaje" class="mt-4 p-3 rounded-lg bg-yellow-100 text-yellow-800 border border-yellow-300">
          {{ mensaje }}
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-[#001C48]">Valor inicial X₀</label>
        <input
          [(ngModel)]="x0"
          class="w-full p-2 rounded bg-gray-100 border border-gray-300 focus:ring-2 focus:ring-[#3BAFDA]"
          type="number"
          placeholder="Ej: 1"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-[#001C48]">Error máximo (%)</label>
        <input
          [(ngModel)]="errorMax"
          class="w-full p-2 rounded bg-gray-100 border border-gray-300 focus:ring-2 focus:ring-[#3BAFDA]"
          type="number"
          placeholder="Ej: 0.01"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-[#001C48]">Iteraciones</label>
        <input
          [(ngModel)]="maxIter"
          class="w-full p-2 rounded bg-gray-100 border border-gray-300 focus:ring-2 focus:ring-[#3BAFDA]"
          type="number"
          placeholder="Ej: 50"
        />
      </div>
    </div>

    <button
      (click)="resolver()"
      class="mt-4 inline-flex items-center gap-2 bg-gradient-to-b from-[#001C48] to-[#003366] text-white font-bold text-sm px-4 py-2 rounded-lg shadow-md hover:shadow-lg"
    >
      Calcular
    </button>
  </div>

  <!-- Gráfico -->
  <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200 flex flex-col items-center">
    <h3 class="text-lg font-bold mb-4 text-[#001C48]">Gráfico de la función</h3>
    <div id="ggb-element" class="w-full max-w-full md:w-3/4 h-[400px] rounded-lg"></div>
  </div>

  <!-- Tabla -->
  <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
    <h3 class="text-lg font-bold mb-4 text-[#001C48]">Resultados</h3>
    <div class="overflow-x-auto">
      <table class="w-full text-sm text-left text-[#001C48] min-w-[700px]">
        <thead class="text-xs bg-gray-100 border-b border-gray-300">
          <tr>
            <th class="px-4 py-3">Iteración</th>
            <th class="px-4 py-3">Xk</th>
            <th class="px-4 py-3">f(Xk)</th>
            <th class="px-4 py-3">f'(Xk)</th>
            <th class="px-4 py-3">
              Xk+1
              <svg data-modal-target="xk1Formule" data-modal-toggle="xk1Formule" class="cursor-pointer h-5 inline-block ml-1 fill-blue-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                <path d="M320 576C178.6 576 64 461.4 64 320C64 178.6 178.6 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576zM320 384C302.3 384 288 398.3 288 416C288 433.7 302.3 448 320 448C337.7 448 352 433.7 352 416C352 398.3 337.7 384 320 384zM320 192C301.8 192 287.3 207.5 288.6 225.7L296 329.7C296.9 342.3 307.4 352 319.9 352C332.5 352 342.9 342.3 343.8 329.7L351.2 225.7C352.5 207.5 338.1 192 319.8 192z"/>
              </svg>
            </th>
            <th class="px-4 py-3">
              Error%
              <svg data-modal-target="error" data-modal-toggle="error" class="cursor-pointer h-5 inline-block ml-1 fill-blue-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                <path d="M320 576C178.6 576 64 461.4 64 320C64 178.6 178.6 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576zM320 384C302.3 384 288 398.3 288 416C288 433.7 302.3 448 320 448C337.7 448 352 433.7 352 416C352 398.3 337.7 384 320 384zM320 192C301.8 192 287.3 207.5 288.6 225.7L296 329.7C296.9 342.3 307.4 352 319.9 352C332.5 352 342.9 342.3 343.8 329.7L351.2 225.7C352.5 207.5 338.1 192 319.8 192z"/>
              </svg>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of resultadosPaginados" class="border-b hover:bg-gray-50">
            <td class="px-4 py-3">{{ r.iteracion }}</td>
            <td class="px-4 py-3">{{ r.xk }}</td>
            <td class="px-4 py-3">{{ r.fxk }}</td>
            <td class="px-4 py-3">{{ r.dfxk }}</td>
            <td class="px-4 py-3">{{ r.xk1 }}</td>
            <td class="px-4 py-3">{{ r.error }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="resultados.length > 0" class="mt-4 text-[#001C48] font-semibold text-lg">
      El resultado de la aproximación es:
      <span class="text-[#003366]">{{ resultados[resultados.length - 1].xk1 }}</span>
    </div>
  </div>
</div>




<!-- modals -->
<div id="xk1Formule" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-[9999] justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-full max-w-2xl max-h-full">
      <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
          <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
              <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                  El valor se obtiene:
              </h3>
              <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="xk1Formule">
                  <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                  </svg>
                  <span class="sr-only">Close modal</span>
              </button>
          </div>
          <div class="p-4 md:p-5 space-y-4">
            <img src="img/sesion3/Xk1Newton.png" 
                class="mx-auto max-w-full h-auto" 
                alt="Fórmula Xk">
          </div>
      </div>
  </div>
</div>

<div id="error" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-[9999] justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-full max-w-2xl max-h-full">
      <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
          <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
              <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                  El valor se obtiene:
              </h3>
              <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="error">
                  <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                  </svg>
                  <span class="sr-only">Close modal</span>
              </button>
          </div>
          <div class="p-4 md:p-5 space-y-4">
            <img src="img/sesion2/error.png" 
                class="mx-auto max-w-full h-auto" 
                alt="Fórmula Xk">
          </div>
      </div>
  </div>
</div>


